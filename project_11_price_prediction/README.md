# Предсказание цены автомобиля 

## Данные

Исторические даные о технических характеристиках, комплектациях и ценах автомобилей.

## Цель

Построить модель для определения стоимости автомобиля. 

## Детали 

Модель будет интегрирована в приложение для определения рыночной цены автомобиля пользователя. Для модели важны:
- качество предсказания;
- скорость пресказания;
- время обучения.

## Используемые библиотеки:

- pandas
- matplotlib (визуализация)
- seaborn
- numpy
- time
- sklearn
- catboost
- lightgbm

## Вывод

Для построения модели для определения стоимости автомодиля необходимо было решить задачу регрессии, при этом необходимо было учитывать скорость обучения и прогнозирования и точность прогноза.

Ход работы: 
1. Данные загружены, проведен первичный осмотр. Обнаружено следующее:
    - Есть пропуски в трех колонках типа object: VehicleType, Gearbox, Model, FuelType, NotRepaired
    - Стиль названия колонок не соответсвуем snake_case
    - Колонки с датами и временем имеют строковый тип данных (что не всегда является проблемой)
    
2. Подготовка данных:
    1. Стиль названия колонок приведен к snake_case
    2. Обработаны пропуски: заполнены значением "unidentified", поскольку все пропуски в столбцах с типом данных object и достоверного способа восстановить их нет
    3. Проведена проверна на наличие дубликатов. Выявлено 4 строки-дубликата (удалены).
    4. Проведен первичный анализ.

3. Подготовлены признаки.
    1. Удалены столбцы, которые не являются признаками: 
    2. Категориальные данные преобразованы в числовые (порядковое кодирование в силу большого числа групп)
    3. Выделен целево признак
    4. Данные разбиты на обучающую и тестовую выборку (4:1)
    5. Отмасштабированы количесвенные признаки

4. Построены модели: 
    - линейная регрессия
    - дерево решений
    - случайный лес
    - CatBoost
    - LightGBM
5. Выбраны гиперпараметры для получения наименьшего RMSE
6. Для лучших моделей вычислено время обучения и прогнозирования

Для решения задачи лучше всего подходит модель 
LGBMRegressor(boosting_type='gbdt', class_weight=None, colsample_bytree=1.0,
              importance_type='split', learning_rate=0.5, max_depth=7,
              min_child_samples=20, min_child_weight=0.001, min_split_gain=0.0,
              n_estimators=200, n_jobs=-1, num_leaves=31, objective=None,
              random_state=1, reg_alpha=0.0, reg_lambda=0.0, silent=True,
              subsample=1.0, subsample_for_bin=200000, subsample_freq=0)