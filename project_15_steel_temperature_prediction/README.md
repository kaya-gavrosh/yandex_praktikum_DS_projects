# Определение температуры стали для производства

Для оптимизации производственных расходов металлургический комбинат решил уменьшить потребление электроэнергии на этапе обработки стали

## Данные

Данные состоят из 7 файлов, полученных из разных источников: <br>
— данные об электродах;
— о подаче сыпучих материалов (объём); 
— о подаче сыпучих материалов (время);
— о продувке сплава газом;
— результаты измерения температуры;
— данные о проволочных материалах (объём);
— о проволочных материалах (время).

Во всех файлах столбец key содержит номер партии. В файлах может быть несколько строк с одинаковым значением key: они соответствуют разным итерациям обработки.

## Цель

Построить модель, которая предскажет температуру стали

## Описание этапа обработки

1. сталь подогревают электродами
2. проверка температуры и химанализ
3. увеличение температуры на несколько минут
4. добавление примесей (сыпучих или проволочных) и продувка газом
5. проверка температуры и химанализ
6. при ненобходимости цикл измерений и добавки лигирующих матералов повторяют до достижения целевого химического состава и оптимальной температуры плавки
7. отправка сплава на доводку/разливку.

## Задачи

1. Проведение анализа данных. Формирование вопросов по результатам анализа и плана дальнейших действий
2. Обсуждение вопросов и уточнение задачи
3. Подготовка данных для модели
4. Создание моделей. Подбор гиперпараметров модели и выбор модели с наилучшей метрикой
5. Тестирование выбранной модели.
6. Анализ важности факторов в выбранной модели

## Детали

Необходимо достич минимальное значение MAE равное 8

## Используемые библиотеки:

- pandas
- numpy
- matplotlib
- seaborn
- scipy
- missingno
- sweetviz
- sklearn
- lightgbm
- catboost
- xgboost

## Отчет

Для уменьшения потребление электроэнергии с целью оптимизации производственных расходов на металлургическом комбинате
необходимо было построить модель, которая предсказывает температуру стали.
Были предоставлены данные по лигирующим добавкам, расходу газа, измерению температуры и мощности электродов,
а также времени замеров и ввода добавок.

В начале работы был проведен анализ полученных данных, по результатам которого были сформированы уточняющие вопросы
и составлен план дальнейших действий.

В ходе работы в целом <u>удалось придерживаться плана, однако были и некоторые отклонения</u> 
- при подготовке данных для моделирования (пункт 3) :
<br>Удаление данных непригодных для построения модели перед формированием признаков было проведено не в полной мере: 
<br>оставлены  аномально большие значения в распределениях для добавок, газа и мощности. 
<br>Обработка аномалий была проведена в ходе анализа и обработки признаков. 
<br>Это было удобнее, поскольку обработка производилась по одной таблице, где для каждой партии выделены необходимые данные, <br>а не по нескольким таблицам с лишней информацией. Для отсечения использовался метод OneClassSVM, с помощью которого 
<br>можно устанавливать долю аномальных объектов в выборке, и таким образом отслеживать, 
<br>насколько удачно обработаны признаки в контексте балланса между обощающей способностью и правильностью предсказаний.
<br>Кроме того, при анализе признаков устранены не только коррелирующие признаки, но и удалены признаки с наименьшей важностью для моделей, что позволило ускорить работу моделей без потери правильности предсказаний.
- при тестировании (пункт 5): 
<br> Тестирование проводилось на всех моделях с лучшеми гиперпараметрами. Соотношение по успешности моделей была та же, что и на тренировочной выборке. В целом это отклонение от плана обусловлено желанием перестраховаться.

В процессе <u>возникли затруднения</u>, связанные с достижением достаточного уровня правильности предсказаний. 
<br>Для улучшения метрики были применены некоторые методы обработки признаков, которые улучшили метрику, но не достаточно. 
<br>Это затруднение решило формирование еще одного признака, который в итоге был оценен моделями как один из самых важных. 

В решении задачи выделю следующие <u>ключевые шаги</u>:
- Анализ данных 
- Составление вопросов к заказчику
- Составление плана действия
- Отбор данных для модели
- Формирование признаков и объединение их в общую таблицу
- Анализ признаков и их обработка
- Подготовка признаков (выделение целевого признака, разбиение на обучающую и тестовую часть, масштабирование/кодирование и т.д.)
- Создание моделей и подбор гиперпараметров
- Тестирование лучших моделей.
- Анализ результатов и выявление лучшей модели.

Лучший результат показала модель CatBoostRegressor, гиперпараметры:
{'iterations': 600,
 'learning_rate': 0.05,
 'loss_function': 'MAE',
 'silent': True,
 'random_state': 12}

Удалось достич MAE 6,44 на тестовой выборке.