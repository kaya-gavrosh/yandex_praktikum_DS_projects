# Классификация комментариев

Интернет-магазин запускает новый сервис, где пользователи могут редактировать и дополнять описания товаров. Магазину необходим инструмент, который будет искать токсичные комментарии и отправлять их на модерацию.

## Данные

Набор данных с разметкой о токсичности правок. Данные находятся в файле toxic_comments.csv. Столбец text содержит текст комментария, а toxic — целевой признак.

## Цель

Обучить модель классифицировать комментарии на позитивные и негативные

## Задачи

1. Загрузить данные и выполнить их ресемплирование по одному часу.
2. Проанализировать данные.
3. Обучить разные модели с различными гиперпараметрами. Сделать тестовую выборку размером 10% от исходных данных.
4. Проверить данные на тестовой выборке и сделать выводы.

## Детали

Построить модель со значением метрики качества F1 не меньше 0.75.

## Используемые библиотеки:

- pandas
- numpy
- re
- nltk
- mglearn
- sklearn

## Вывод

Для обучения модели классифицировать комментарии на позитивные и негативные были проделаны следующие шаги.

1. Данные были загружены 
2. Прведена подготовка данных:
    * слова приведены к лемме  и чистка текста от лишних символов
    * выделен корпус
    * созданы счетчики для подсчета TF-IDF: с игнорированием редко встречающихся в наборе слов и без.
3. Подготовка признаков
    * выделен целевой признак
    * выделена тестовая выборка (25%); обучающие признаки - исходные данные, на которых обученные и которые преобразованны TfidfVectorizer, тестовые - данные преобразованные TfidfVectorizer
    * на наивном байесовском классификаторе проверено, какой издвух счетчиков выдает лучший результат. Это счетчик с установленным min_df=5
    * построены  модели и подобраны геперпараметры для вышеупомянутой модели и логистической регрессии 

С помощью модели логистической регрессии с гиперпараметрами, указанными ниже, удалось достичь f1 равное 0,78

Гиперпараметры модели логистической регрессии:<br>
{'C': 10,
 'class_weight': None,
 'dual': False,
 'fit_intercept': True,
 'intercept_scaling': 1,
 'l1_ratio': None,
 'max_iter': 1000,
 'multi_class': 'auto',
 'n_jobs': None,
 'penalty': 'l2',
 'random_state': None,
 'solver': 'lbfgs',
 'tol': 0.0001,
 'verbose': 0,
 'warm_start': False}