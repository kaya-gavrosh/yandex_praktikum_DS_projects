# Определение возраста покупателей

Сетевой супермаркет «Хлеб-Соль» внедряет систему компьютерного зрения для обработки фотографий покупателей. Фотофиксация в прикассовой зоне поможет определять возраст клиентов, чтобы:
<br>- анализировать покупки и предлагать товары, которые могут заинтересовать покупателей этой возрастной группы;
- контролировать добросовестность кассиров при продаже алкоголя.

## Данные

Набор фотографий людей с указанием возраста

## Цель

Построить модель, которая по фотографии определит приблизительный возраст человека

## Задачи

1. Исследовательский анализ данных.
2. Подготовка данных к обучению.
3. Обучение модели.
4. Анализ модели.

## Детали

Построить модель с MAE меньшее 8

## Используемые библиотеки:

- pandas
- numpy
- matplotlib
- PIL
- tensorflow.keras

## Выводы

Изображения (обучающая и валидационная выборки) были загружены размером 224х224 с применением аугментации (отражения по вертикали и горизонтали), приведены к масштабу [0,1].

Проведен анализ изображений:

- Наблюдается несколько пиков: в 14 (наибольший), около 30 и 23 лет. Возможно, их наличие обусловлено случайностью выборки. Наибольшее число наблюдений расположено на отрезке [14:50] - люди такого возраста совершают покупки чаще всего.
- Есть как черно-белые, так и цветные фото, фото в разных ракурсах, разного качества, разной освещенности - это может улучшить обучение за счет разнообразия признаков. Также на всех фото лица людей приблизительно одного размера и расположены по центру, что тоже облегчает распознование.

Создана своей сети на основе ResNet50. Последние два слоя удалены. Вместо них использовались GlobalAveragePooling2D() и полносвязный Dense() с одним нейроном, что соответствует задачи регрессии. В качестве функции активации использована ReLu, поскольку она не изменяет положительные значения. 

В качестве алгоритма для обучения выбран Adam, скорость обучения установлена на 0.0001. Функция потерь - MSE, метрика - MAE. 

Обучение проходит на 7 эпохах. При увеличении числа эпох может срабатывать callback из-за того, что значение MAE на валидационной выборке может увеличиваться, вероятно из-за переобучения.

Модель по фотографии определяет приблизительный возраст человека со значение MAE меньшее 8, что соответствует заявленной цели.